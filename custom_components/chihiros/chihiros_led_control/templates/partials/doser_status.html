{% if error %}
<article class="secondary">{{ error }}</article>
{% endif %}
{% if message %}
<article>{{ message }}</article>
{% endif %}
{% if status %}
<article>
  <header>
    <h4>Doser Status</h4>
  </header>
  {% set parsed = status.parsed %}
  {% if parsed %}
    {% if parsed.weekday is not none and parsed.hour is not none %}
      <p>Weekday {{ parsed.weekday }} Time {{ '%02d:%02d'|format(parsed.hour, parsed.minute or 0) }}</p>
    {% endif %}
    <table>
      <thead>
        <tr>
          <th>#</th>
          <th>Mode</th>
          <th>Time</th>
          <th>Dosed</th>
          <th>Target</th>
        </tr>
      </thead>
      <tbody>
        {% for head in parsed.heads %}
        <tr>
          <td>{{ loop.index }}</td>
          <td>{{ head.mode }}</td>
          <td>{{ '%02d:%02d'|format(head.hour, head.minute) }}</td>
          <td>{{ '%.1f'|format((head.dosed_tenths_ml or 0)/10) }} ml</td>
          <td>{{ parsed.tail_targets[loop.index0] if loop.index0 < parsed.tail_targets|length else 'â€“' }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p>No parsed data available.</p>
  {% endif %}
</article>
{% else %}
<p>No status available.</p>
{% endif %}
